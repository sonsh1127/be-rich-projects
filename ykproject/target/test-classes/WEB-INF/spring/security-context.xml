<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns="http://www.springframework.org/schema/security"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-4.2.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd">
	<!-- // expressions을 추가해야 hasRole,permitAll등의 다양한 옵션들을 쓸수 있음 -->

	<context:component-scan
		base-package="kr.co.circlenine.security"></context:component-scan>
	<context:component-scan
		base-package="kr.co.circlenine.service"></context:component-scan>
	<context:component-scan
		base-package="kr.co.circlenine.dao"></context:component-scan>

	<!-- Spring Security Login auto-config: 기본 true로 설정 use-expressions: true일때는 
		아래의 access 속성과 같이 사용 intercept-url 앨리먼트: pattern 주소에 접근가능한 권한을 설정하기 위해 사용 
		- pattern: 적용범위 - access: 접근권한 - 아래의 예는 모든 url 주소에 대해 모든 권한으로 접근 가능하지만 /admin 
		이하의 경로는 로그인한 관리자만 접근이 가능하고 /board 이하의 경로는 로그인한 일반사용자와 관리자만 접근이 가능하다는 뜻이다. 
		form-login 앨리먼트: 클라이언트의 로그인 폼에 입력한 정보를 전달받을 때 약속을 정하기 위해 사용 - login-page: 
		스프링에게 로그인 페이지 위치를 알려준다. - login-processing-url: 스프링이 로그인을 처리할 것이니 클라이언트에게 
		로그인을 처리할 주소를 알려주기위해 주소를 원하는 이름으로 작성한다. - authentication-failure-url: 로그인이 
		실패 했을 때 이동할 주소를 스프링에게 알려준다. - username-parameter: 클라이언트가 전달할 파라미터(이메일) 이름을 
		스프링에게 알려준다. - password-parameter: 클라이언트가 전달할 파라미터(비밀번호) 이름을 스프링에게 알려준다. access-denied-handler 
		앨리먼트 - error-page: 로그인한 사용자가 접근 불가한 페이지로 접근 시 보여줄 페이지 설정 csrf 앨리먼트: 클라이언트 
		폼 전송 시 보안을 위해 설정 -->

	<http auto-config="true" use-expressions="true">
		<form-login login-page="/loginForm" />
		<intercept-url pattern="/common/*" access="hasRole('ROLE_USER')" />
<!-- 		<intercept-url pattern="/common/**" access="permitAll" /> -->
		<intercept-url pattern="/*" access="permitAll" />
		<csrf />
	</http>

	<authentication-manager
		alias="authenticationManager">
		<authentication-provider
			ref="customAuthenticationProvider" />
		<authentication-provider
			user-service-ref="customUserDetailService">
			<password-encoder ref="passwordEncoder" />
		</authentication-provider>
<!-- 		<authentication-provider> -->
<!-- 			<user-service> -->
<!-- 				<user name="zkfkzktm" password="1q2w3e4r" -->
<!-- 					authorities="ROLE_USER" /> -->
<!-- 			</user-service> -->
<!-- 		</authentication-provider> -->
	</authentication-manager>
</beans:beans>